<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Whack-a-Mole</title>
  <style>
    .board {
      display: grid;
      grid-template-columns: repeat(3, 100px);
      gap: 10px;
      margin-bottom: 10px;
    }
    .cell {
      width: 100px;
      height: 100px;
      background: #ddd;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 40px;
      cursor: pointer;
    }
    .mole {
      background: gold;
    }
  </style>
</head>
<body>

    <h2>ë‘ë”ì§€ ì¡ê¸° ê²Œì„</h2>
    <div>ì…€ ê°œìˆ˜: <input type="number" id="cellNum" value="9"></div> 
    <button id="setBtn">ì…€ ìƒì„±</button>
    <div>ì ìˆ˜: <span id="score">0</span></div>
    <div>ë‚¨ì€ ì‹œê°„: <span id="time">10</span></div>
    <button id="startBtn">ê²Œì„ ì‹œì‘</button>

<div class="board" id="board"></div>

<script>
    const board = document.getElementById("board");
    const scoreEl = document.getElementById("score");
    const startBtn = document.getElementById("startBtn");

    // ë‚¨ì€ ì‹œê°„ì„ ë³´ì—¬ì£¼ëŠ” ê¸°ëŠ¥ ë§Œë“¤ì–´ë³´ê¸°
    const timeEl = document.getElementById("time");

    // ì…€ ê°œìˆ˜ë¥¼ ì…ë ¥ë°›ê³  ì¶œë ¥í•˜ëŠ” ê¸°ëŠ¥
    const cellNum = document.getElementById("cellNum");
    const setBtn = document.getElementById("setBtn");

    let score = 0;
    let timer = null;
    let currentIndex = -1;
    
    // ì‹¤ì œ í™”ë©´ìƒì— ì¶œë ¥ë  ì‹œê°„ ê°’
    let timeLefted = 10;

    // í•¨ìˆ˜(setInterval)ì˜ ë°˜í™˜ê°’ì„ ì œì–´í•˜ê¸° ìœ„í•œ ë³€ìˆ˜
    let timeInterval = null;

    // cellsë¥¼ ì „ì—­ì—ì„œ ì“¸ ìˆ˜ ìˆë„ë¡ ì„ ì–¸
    let cells = [];

  // 1. ë³´ë“œ ìƒì„± (DOM Create)
  /*
  - 9ê°œì˜ ì…€(div)ì„ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ì—¬ boardì— ì¶”ê°€í•œë‹¤.
  - ê° ì…€ì— classNameìœ¼ë¡œ "cell"ì„ ì§€ì •í•œë‹¤.
  - ê° ì…€ì— dataset.indexë¡œ 0~8ê¹Œì§€ì˜ ì¸ë±ìŠ¤ë¥¼ ì €ì¥í•œë‹¤.
  - board.appendChild()ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±í•œ divë¥¼ boardì— ì¶”ê°€í•œë‹¤.
  */

 // for ë°˜ë³µë¬¸ìœ¼ë¡œ xê¹Œì§€ êµ´ë¦¬ë©´ì„œ ië¡œ ì¸ë±ìŠ¤ ì„¤ì •
 // xë¼ëŠ” ì„ì˜ì˜ ë³€ìˆ˜ë¡œ ì…€ ê°œìˆ˜ë¥¼ í†µì œ
 // ì´ xë¼ëŠ” ê°’ì„ ì–´ë–»ê²Œ ë°›ì„ ê²ƒì¸ì§€ë¥¼ ê²°ì •í•´ì•¼í•¨

 // setBtn ë²„íŠ¼ì„ í´ë¦­í•¨ìœ¼ë¡œì„œ ì…€ì´ ìƒì„±ë˜ëŠ” ë¡œì§ì´ ì‘ë™í•˜ê²Œë” êµ¬í˜„
    setBtn.addEventListener("click", () => {
      const x = Number(cellNum.value);

      // ì¤‘ë³µ ìƒì„±ì„ ë§‰ê¸° ìœ„í•´ ê¸°ì¡´ ë³´ë“œë¥¼ ë¹„ì›Œì£¼ê¸°
      board.innerHTML = "";
      cells = [];

      for (let i = 0; i < x; i++) {
          const div = document.createElement("div");
          div.className = "cell";
          div.dataset.index = i;

          // ê¸°ì¡´ ì½”ë“œëŠ” í´ë¦­ ì´ë²¤íŠ¸ë¥¼ í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
          // í•˜ì§€ë§Œ í˜„ ì½”ë“œëŠ” ë²„íŠ¼ ìƒì„± ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚¤ê¸° ì „ê¹Œì§€ ì…€ ìƒì„±ì´ ì•ˆë¨
          // ê·¸ëŸ¬ë‹ˆ í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ì…€ ìƒì„± ë£¨í”„ ì•ˆì— ì²˜ë¦¬ (for Each ì‚¬ìš© X)

          /*
          - ëª¨ë“  ì…€ì— í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•œë‹¤.
          - í´ë¦­í•œ ì…€ì˜ ì¸ë±ìŠ¤(dataset.index)ì™€ currentIndexë¥¼ ë¹„êµí•œë‹¤.
          - ë‘ë”ì§€ê°€ ìˆëŠ” ì…€ì„ í´ë¦­í–ˆë‹¤ë©´ scoreë¥¼ 1 ì¦ê°€ì‹œí‚¨ë‹¤.
          - ë³€ê²½ëœ ì ìˆ˜ë¥¼ scoreElì— í‘œì‹œí•œë‹¤.
          */
            div.addEventListener("click", () => {
                // í´ë¦­í•œ ì…€ì˜ indexë¥¼ ìˆ«ìë¡œ ì¹˜í™˜í•œ ë’¤ ì •ë‹µê°’(currentIndex)ì™€ ëŒ€ì¡°
                if(Number(div.dataset.index) === currentIndex) {
                    // ë§Œì•½ ë™ì¼í•œ ê°’ì¼ ê²½ìš° ì ìˆ˜ë¥¼ 1ì  ì¶”ê°€ í›„ í•´ë‹¹ ì ìˆ˜ë¥¼ í‘œì‹œ
                  score++
                  scoreEl.textContent = score;
                  }
              });

              board.appendChild(div);
              cells.push(div); // ì „ì—­ ë°°ì—´ì— ë‹´ê¸°

              }

              // ì…€ ê°œìˆ˜ì— ë§ì¶° ê·¸ë¦¬ë“œ ì—´ ê°œìˆ˜ ìë™ ì¡°ì •
              const cols = Math.ceil(Math.sqrt(x));
              board.style.gridTemplateColumns = `repeat(${cols}, 100px)`;
    });

  // cells ìƒìˆ˜ê°€ ëª¨ë“  cellì„ ë‹´ê³  ìˆì–´ì•¼ í•¨.
  // const cells = document.querySelectorAll(".cell") 
  // documentì—ì„œ í´ë˜ìŠ¤ ì´ë¦„ì´ cellì¸ ëª¨ë“  ìš”ì†Œë¥¼ ì°¾ì•„ cellsë¼ëŠ” ìƒìˆ˜ë¡œ ì •ì˜
  // const cells = document.querySelectorAll(".cell");
  // ë‹¨, í•´ë‹¹ ì½”ë“œëŠ” ì‹¤í–‰ ì‹œì ì— .cell í´ë˜ìŠ¤ê°€ ì—†ê¸° ë•Œë¬¸ì— ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ (ì „ì—­ì˜ cells ë°°ì—´ì„ ì‚¬ìš©í•˜ëŠ”ê²ƒìœ¼ë¡œ ê°ˆìŒ)
  
    


  // 2. ëœë¤ ë‘ë”ì§€ ë“±ì¥
  /*
  - ëª¨ë“  ì…€ì—ì„œ ë‘ë”ì§€ë¥¼ ì œê±°í•œë‹¤ (mole í´ë˜ìŠ¤ ì œê±°, í…ìŠ¤íŠ¸ ë¹„ìš°ê¸°).
  - 0 ~ 8 ì‚¬ì´ì˜ ëœë¤í•œ ìˆ«ìë¥¼ ìƒì„±í•œë‹¤.
  - ëœë¤í•˜ê²Œ ì„ íƒëœ ì…€ì— "mole" í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ê³ , ğŸ¹ ì´ëª¨ì§€ë¥¼ í‘œì‹œí•œë‹¤.
  - currentIndex ë³€ìˆ˜ì— í˜„ì¬ ë‘ë”ì§€ ìœ„ì¹˜ë¥¼ ì €ì¥í•œë‹¤.
  */
    function showMole() {
        // forEachë¥¼ í†µí•´ cellsë¥¼ ìˆœíšŒí•˜ë©° moleì´ë¼ëŠ” classë¥¼ ì „ë¶€ ì‚­ì œ
        cells.forEach(c => {
            c.classList.remove("mole");
            c.textContent = "";
        });

        // ì…€ì˜ ê°¯ìˆ˜ ë§Œí¼ì˜ ë²”ìœ„ì— í•´ë‹¹í•˜ëŠ” ëœë¤í•œ ìˆ«ìë¥¼ ìƒì„±
        const rand = Math.floor(Math.random() * cells.length);

        // í•´ë‹¹ ìˆ«ìì˜ ì¸ë±ìŠ¤ì— mole í´ë˜ìŠ¤ë¥¼ ìƒì„±
        cells[rand].classList.add("mole");
        cells[rand].textContent = "ğŸ¹";

        // currentIndex = rand; ë¶™ì´ê¸°(ì´ ì½”ë“œê°€ ì—†ìœ¼ë©´ ëœë¤í•˜ê²Œ ì •í•´ì§€ëŠ” ì •ë‹µì„ ê¸°ë¡í•˜ì§€ ëª»í•¨)
        currentIndex = rand;
    }


  

  // 3. ê²Œì„ ì‹œì‘ ë²„íŠ¼
  /*
  - ì‹œì‘ ë²„íŠ¼ì— í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•œë‹¤.
  - ì´ë¯¸ ê²Œì„ì´ ì§„í–‰ ì¤‘ì´ë©´(timerê°€ ìˆìœ¼ë©´) í•¨ìˆ˜ë¥¼ ì¢…ë£Œí•œë‹¤.
  - ê²Œì„ ì‹œì‘ ì‹œ scoreë¥¼ 0ìœ¼ë¡œ ì´ˆê¸°í™”í•˜ê³  í™”ë©´ì— í‘œì‹œí•œë‹¤.
  - setInterval()ì„ ì‚¬ìš©í•˜ì—¬ 0.8ì´ˆë§ˆë‹¤ showMole() í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.
  - setTimeout()ì„ ì‚¬ìš©í•˜ì—¬ 10ì´ˆ í›„ ê²Œì„ì„ ì¢…ë£Œí•œë‹¤.
  - ê²Œì„ ì¢…ë£Œ ì‹œ: clearInterval()ë¡œ íƒ€ì´ë¨¸ ì¤‘ì§€, timerë¥¼ nullë¡œ ì´ˆê¸°í™”,
    alert()ë¡œ ìµœì¢… ì ìˆ˜ë¥¼ í‘œì‹œí•œë‹¤.
  */

    // time ë³€ìˆ˜ë¥¼ 1ì”© ê°ì†Œì‹œí‚¤ê³ , í•´ë‹¹ ê°’ì„ í™”ë©´ì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
    function timeControl () {
        timeLefted -= 1;
        timeEl.textContent = timeLefted;
    }


    startBtn.addEventListener("click", () => {
        // ì´ë¯¸ íƒ€ì´ë¨¸ ì§„í–‰ ì¤‘ì´ë©´ ì¢…ë£Œ
        if(timer) return;

        // ê²Œì„ ì‹œì‘ì‹œ ìŠ¤ì½”ì–´ 0ìœ¼ë¡œ ì´ˆê¸°í™”
        score = 0;
        scoreEl.textContent = score;

        // ê²Œì„ ì‹œì‘ì‹œ ë‚¨ì€ ì‹œê°„ì„ 10ìœ¼ë¡œ ì´ˆê¸°í™”
        timeLefted = 10;
        timeEl.textContent = 10;


        // 0.8ì´ˆë§ˆë‹¤ showMole í•¨ìˆ˜ë¥¼ ì‹¤í–‰
        timer = setInterval(showMole, 800);

        // 1ì´ˆë§ˆë‹¤ timeControl í•¨ìˆ˜ë¥¼ ì‹¤í–‰
        timeInterval = setInterval(timeControl, 1000);

        setTimeout(()=> {
            // 10ì´ˆ ê²½ê³¼ ì‹œ timerê°’ê³¼ timeIntervalê°’ ì´ˆê¸°í™”
            clearInterval(timer);
            clearInterval(timeInterval);
            timer = null;
            timeInterval = null;

            alert("ê²Œì„ ì¢…ë£Œ! ì ìˆ˜: " + score);
        }, 10000)
        
        
    })
</script>

</body>
</html>

